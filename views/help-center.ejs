<!DOCTYPE html>
<html class="light" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="shopify-api-key" content="<%= SHOPIFY_API_KEY %>">
  <title>Help Center - Delybell Order Sync</title>
  
  <!-- Shopify App Bridge -->
  <script src="https://cdn.shopify.com/shopifycloud/app-bridge.js"></script>
  <script src="https://cdn.shopify.com/shopifycloud/app-bridge-utils.js"></script>
  <script>
    window.SHOPIFY_API_KEY = '<%= SHOPIFY_API_KEY %>';
    window.SHOPIFY_SHOP = '<%= shop %>';
  </script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#010a8b",
            "primary-purple": "#7c3aed",
            "background-light": "#fafafa",
            "background-dark": "#0a0a0a",
            "surface-light": "#ffffff",
            "surface-dark": "#1a1a1a",
            "border-light": "#e5e5e5",
            "border-dark": "#2a2a2a",
          },
          fontFamily: {
            display: ["Inter", "sans-serif"],
            sans: ["Inter", "sans-serif"],
          },
          borderRadius: {
            DEFAULT: "8px",
          },
        },
      },
    };
  </script>
  
  <style>
    body { font-family: 'Inter', sans-serif; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    .dark ::-webkit-scrollbar-thumb { background: #4b5563; }
  </style>
</head>
<body class="bg-[#fafafa] dark:bg-[#0a0a0a] text-slate-900 dark:text-slate-100 min-h-screen transition-colors duration-200">
  <div class="max-w-[1600px] mx-auto px-6 py-6">
    <!-- Header - Minimal -->
    <header class="mb-6 flex justify-between items-start">
      <div>
        <h1 class="text-xl font-semibold text-slate-900 dark:text-white mb-1">Help Center</h1>
        <p class="text-xs text-slate-500 dark:text-slate-400">Get help with Delybell Order Sync</p>
      </div>
      <div class="flex gap-2">
        <a href="/app<%= shop ? '?shop=' + encodeURIComponent(shop) : '' %>" class="px-3 py-1.5 bg-white dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-md font-medium text-xs hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors inline-flex items-center gap-1.5" id="backToDashboard">
          <span class="material-icons-outlined text-sm">arrow_back</span>
          Back
        </a>
      </div>
    </header>
    
    <!-- Help Content -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Main Content -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Getting Started - Minimal -->
        <div class="bg-white dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark p-4 mb-4">
          <div class="flex items-center gap-2 mb-3">
            <div class="w-8 h-8 rounded-md bg-[#010a8b]/10 flex items-center justify-center">
              <span class="material-icons-outlined text-[#010a8b] text-lg">rocket_launch</span>
            </div>
            <h2 class="text-base font-semibold">Getting Started</h2>
          </div>
          <div class="space-y-3 text-xs text-slate-600 dark:text-slate-400">
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">1. Install the App</h3>
              <p>Install Delybell Order Sync from the Shopify App Store. Your store connects automatically.</p>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">2. Manual Sync</h3>
              <p>Orders appear in your dashboard. Review and sync them manually when ready.</p>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">3. Monitor Orders</h3>
              <p>View sync status, payment info, and Delybell order IDs in the Orders table.</p>
            </div>
          </div>
        </div>
        
        <!-- Manual Sync Explained - Minimal -->
        <div class="bg-white dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark p-4 mb-4">
          <div class="flex items-center gap-2 mb-3">
            <div class="w-8 h-8 rounded-md bg-[#010a8b]/10 flex items-center justify-center">
              <span class="material-icons-outlined text-[#010a8b] text-lg">sync</span>
            </div>
            <h2 class="text-base font-semibold">Manual Sync</h2>
          </div>
          <div class="bg-[#010a8b]/5 dark:bg-[#010a8b]/10 border border-[#010a8b]/20 dark:border-[#010a8b]/30 rounded-md p-3">
            <p class="text-xs text-slate-700 dark:text-slate-300 mb-2">
              Orders are saved automatically but require manual sync to send to Delybell.
            </p>
            <ul class="text-xs text-slate-600 dark:text-slate-400 space-y-1 ml-4 list-disc">
              <li>Review orders before syncing</li>
              <li>Select orders using checkboxes</li>
              <li>Click "Sync Selected" to send</li>
              <li>Track sync status in real-time</li>
            </ul>
          </div>
        </div>
        
        <!-- Common Questions - Minimal -->
        <div class="bg-white dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark p-4 mb-4">
          <div class="flex items-center gap-2 mb-3">
            <div class="w-8 h-8 rounded-md bg-[#7c3aed]/10 flex items-center justify-center">
              <span class="material-icons-outlined text-[#7c3aed] text-lg">help_outline</span>
            </div>
            <h2 class="text-base font-semibold">FAQ</h2>
          </div>
          <div class="space-y-3">
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">How do I sync orders?</h3>
              <p class="text-xs text-slate-600 dark:text-slate-400">
                Use checkboxes to select orders, then click "Sync Selected" to send them to Delybell.
              </p>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">What does "Failed" mean?</h3>
              <p class="text-xs text-slate-600 dark:text-slate-400">
                Order couldn't be sent. Click "Retry" to try again. Common issues: address problems or connection errors.
              </p>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">What is Delybell Order ID?</h3>
              <p class="text-xs text-slate-600 dark:text-slate-400">
                Unique ID assigned when order is synced. Use it to track orders in Delybell system.
              </p>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">How do I check connection?</h3>
              <p class="text-xs text-slate-600 dark:text-slate-400">
                Check status cards at top. Connected shows blue/purple indicators.
              </p>
            </div>
          </div>
        </div>
        
        <!-- Troubleshooting - Minimal -->
        <div class="bg-white dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark p-4 mb-4">
          <div class="flex items-center gap-2 mb-3">
            <div class="w-8 h-8 rounded-md bg-[#010a8b]/10 flex items-center justify-center">
              <span class="material-icons-outlined text-[#010a8b] text-lg">build</span>
            </div>
            <h2 class="text-base font-semibold">Troubleshooting</h2>
          </div>
          <div class="space-y-3">
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">Orders not syncing</h3>
              <ul class="text-xs text-slate-600 dark:text-slate-400 space-y-1 ml-4 list-disc">
                <li>Check connection status</li>
                <li>Verify Delybell is connected</li>
                <li>Try refreshing the page</li>
              </ul>
            </div>
            <div>
              <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-1">Can't see orders</h3>
              <ul class="text-xs text-slate-600 dark:text-slate-400 space-y-1 ml-4 list-disc">
                <li>Check filter tabs</li>
                <li>Click "Refresh" button</li>
                <li>Orders appear after creation</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Sidebar -->
      <div class="space-y-6">
        <!-- Quick Links - Minimal -->
        <div class="bg-white dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark p-4 mb-4">
          <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-3">Quick Links</h3>
          <div class="space-y-1.5">
            <a href="/app<%= shop ? '?shop=' + encodeURIComponent(shop) : '' %>" class="flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400 hover:text-[#010a8b] transition-colors">
              <span class="material-icons-outlined text-sm">dashboard</span>
              Dashboard
            </a>
            <a href="/app<%= shop ? '?shop=' + encodeURIComponent(shop) : '' %>" class="flex items-center gap-2 text-xs text-slate-600 dark:text-slate-400 hover:text-[#010a8b] transition-colors">
              <span class="material-icons-outlined text-sm">receipt_long</span>
              View Orders
            </a>
          </div>
        </div>
        
        <!-- Need More Help - Minimal -->
        <div class="bg-[#010a8b]/5 dark:bg-[#010a8b]/10 rounded-lg border border-[#010a8b]/20 dark:border-[#010a8b]/30 p-4">
          <h3 class="font-semibold text-sm text-slate-900 dark:text-white mb-2">Need Help?</h3>
          <p class="text-xs text-slate-600 dark:text-slate-400 mb-3">
            Contact support if you need assistance.
          </p>
          <button onclick="showReportProblemModal()" class="w-full px-3 py-1.5 bg-[#010a8b] text-white rounded-md text-xs font-semibold hover:opacity-90 transition-opacity">
            Contact Support
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
  <footer class="mt-16 pt-8 border-t border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark">
    <div class="max-w-6xl mx-auto px-6 py-6">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-slate-500 dark:text-slate-400">
        <div class="flex items-center gap-6 flex-wrap justify-center md:justify-start">
          <span class="font-semibold text-slate-700 dark:text-slate-300">Delybell Order Sync</span>
          <a href="/privacy" class="hover:text-primary transition-colors">Privacy Policy</a>
          <a href="/terms" class="hover:text-primary transition-colors">Terms of Service</a>
        </div>
        <div class="text-center md:text-right">
          <p>&copy; <%= new Date().getFullYear() %> Delybell. All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>
  
  <!-- Dark Mode Toggle -->
  <div class="fixed bottom-6 right-6">
    <button class="p-3 bg-white dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-full shadow-lg hover:scale-110 transition-transform" onclick="document.documentElement.classList.toggle('dark')">
      <span class="material-icons-outlined dark:hidden">dark_mode</span>
      <span class="material-icons-outlined hidden dark:block text-yellow-400">light_mode</span>
    </button>
  </div>
  
  <script>
    // Ensure shop parameter is preserved in navigation
    (function() {
      const shop = window.SHOPIFY_SHOP || '<%= shop %>';
      if (shop) {
        sessionStorage.setItem('shopDomain', shop);
        
        // Update back link to include shop parameter
        const backLink = document.getElementById('backToDashboard');
        if (backLink) {
          const currentUrl = new URL(backLink.href, window.location.origin);
          if (!currentUrl.searchParams.has('shop')) {
            currentUrl.searchParams.set('shop', shop);
            backLink.href = currentUrl.pathname + currentUrl.search;
          }
        }
      } else {
        // Try to get from URL or sessionStorage
        const urlParams = new URLSearchParams(window.location.search);
        const shopFromUrl = urlParams.get('shop');
        const shopFromStorage = sessionStorage.getItem('shopDomain');
        
        if (shopFromUrl) {
          sessionStorage.setItem('shopDomain', shopFromUrl);
          const backLink = document.getElementById('backToDashboard');
          if (backLink) {
            const currentUrl = new URL(backLink.href, window.location.origin);
            currentUrl.searchParams.set('shop', shopFromUrl);
            backLink.href = currentUrl.pathname + currentUrl.search;
          }
        } else if (shopFromStorage) {
          // Update back link with shop from storage
          const backLink = document.getElementById('backToDashboard');
          if (backLink) {
            const currentUrl = new URL(backLink.href, window.location.origin);
            currentUrl.searchParams.set('shop', shopFromStorage);
            backLink.href = currentUrl.pathname + currentUrl.search;
          }
        }
      }
    })();
  </script>
</body>
</html>
